#VMM 论文阅读报告
//Dong
//2016.03.15

##Dune: safe user-level access to privileged cpu features

###论文内容：
这篇论文实现了一个可以在User level安全访问privileged CPU的系统。
系统实现了对进程的虚拟化，使用户程序能够直接使用虚拟硬件。
并且实现了垃圾回收，沙盒和特权隔离这三个用户程序来测试系统效率。

###论文方法：
论文基于Intel的VT-x的虚拟化支持，在kernel中添加了一个Dune model实现利用提供的VMX non-root mode实现不信任代码对privileged CPU的使用。

Dune程序为了和linux其他程序共享内存环境，Dune程序添加了自己的页表，并且页表地址转换之后，通过EPT再映射为实际内存地址。同时使用hook机制和linux环境同步更新页表项。

同时在library libDune实现对底层硬件访问的封装。

Dune支持syscall调用，并且是程序自身响应处理，并且当程序想要调用系统的系统功能时，可以通过vmcall调用，跳转到内核执行对应的系统调用。

而Dune对于信号的处理，kernel接收到信号之后，给与Dune程序一个中断，并将信号信息传递给Dune程序。

值得一提的是，为了能够和kernel共享内存等设备，对于每一个Dune程序，都维护了一套环境配置，如%CR3寄存器等。

基于Dune系统，实现了三个应用来显示系统的可用性和高效性。利用Dune实现沙盒，使任何不可信的程序想要访问内核，更改特权等级访问非法内存时都能有效中断并且处理；Wedge系统实现多个线程的生成和运行；垃圾回收中页表项更新，TLB控制等。

###论文贡献点：
在保证系统安全性的前提下，实现了User level对privileged CPU的访问，而无需对于每一应用都更改内核。

实现系统，并加入三个应用测试系统性能，并且运行时间比linux方案均要快。


###论文缺点：

没有比较在I/O或信号处理较多的应用中系统的性能。

多Dune程序运行时效果如何？


##IX: A Protected Dataplane Operating System for High Throughput and Low Latency

###论文内容：
论文设计并实现了一个基于硬件虚拟化的I/O性能卓越的操作系统。并且系统提高很高的安全性。

###论文方法：
利用Dune提供的Dune Module，应用程序（Dataplane）直接访问硬件资源，以获得高效的I/O传输。

同时将应用层的Dataplane分割成两部分，IX运行在VMX non-root下的ring 0，这样能够访问虚拟硬件的特权指令，并且确保运行在ring 3上的网络应用（不安全代码）能够安全的访问硬件而不会使整个系统出现问题。

为了解决频繁触发I/O中断带来的延迟，系统设计采用了对数据拉取和批处理，减少系统调用次数，以减少运行时间。并且为了适应不同的数据输入速度，适应的调整批处理大小。

Dataplane和应用共享一份数据，以zero-copy方式实现对数据的处理，减少了处理延迟。

每个NIC queue都分配了一个独享的内存池，并以单独的硬件进程处理，这样在实现时，实现了lock-free，能够很好的支持多核处理。

###论文贡献点：
当前系统中，硬件I/O支持很快的输入输出和低延迟，但是软件系统不能有效利用这些资源，文章利用硬件虚拟化提供了IX系统，能够有效利用I/O资源。

以拉取和批处理的方式处理网络协议数据，减少系统调用次数，减少在大数量系统中的延迟。

###论文缺点及疑问：

当程序不能及时处理batch数据时，系统如何处理？

Batch和latency的关系，batch越小因为系统调用造成的延迟越大，batch越大，当系统的输入输出较小时也造成延迟增大，虽然现在延迟比linux小，但是是否能有更有效的减少延迟的办法？

